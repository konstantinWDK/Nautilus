#!/bin/bash
# prerm script para nautilus-vscode-widget v3.3.7
# OptimizaciÃ³n de rendimiento - detecciÃ³n bajo demanda

set -e

# Colores
CYAN='\033[0;36m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
GREEN='\033[0;32m'
NC='\033[0m'

case "$1" in
    remove|upgrade|deconfigure)
        echo -e "${YELLOW}ðŸ”„ Deteniendo Nautilus VSCode Widget...${NC}"
        
        # Detener procesos de forma mÃ¡s segura
        pkill -f "nautilus-vscode-widget" 2>/dev/null || true
        pkill -f "nautilus-vscode-widget.py" 2>/dev/null || true
        
        # Esperar un poco para que los procesos se cierren
        sleep 1
        
        # Forzar cierre si es necesario (solo para remove)
        if [ "$1" = "remove" ]; then
            pkill -9 -f "nautilus-vscode-widget" 2>/dev/null || true
            pkill -9 -f "nautilus-vscode-widget.py" 2>/dev/null || true
        fi
        
        echo -e "${GREEN}âœ… Widget detenido${NC}"
        ;;
esac

exit 0
