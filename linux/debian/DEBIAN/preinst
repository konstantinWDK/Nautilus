#!/bin/bash
# Script pre-instalación para nautilus-vscode-widget
# Solo verifica dependencias, NO las instala automáticamente

set -e

echo "Verificando dependencias..."

# Lista de paquetes necesarios
DEPENDENCIES="python3 python3-gi python3-gi-cairo gir1.2-gtk-3.0 python3-xlib xdotool wmctrl"

# Verificar si todas las dependencias están instaladas
MISSING_DEPS=""
for pkg in $DEPENDENCIES; do
    if ! dpkg -l | grep -q "^ii  $pkg "; then
        MISSING_DEPS="$MISSING_DEPS $pkg"
    fi
done

# Si faltan dependencias, mostrar mensaje informativo
if [ -n "$MISSING_DEPS" ]; then
    echo "⚠️  Dependencias faltantes:$MISSING_DEPS"
    echo "Por favor, instálalas manualmente con:"
    echo "  sudo apt install$MISSING_DEPS"
    echo "O usa 'sudo apt install ./nautilus-vscode-widget_3.3.0_all.deb' para instalación automática"
    # NO salir con error, permitir que el sistema gestione las dependencias
else
    echo "✓ Todas las dependencias ya están instaladas"
fi

exit 0
